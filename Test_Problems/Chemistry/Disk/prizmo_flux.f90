module prizmo_flux
  use prizmo_commons
  use prizmo_rates
contains

  ! *****************
  function get_flux(x, Tgas, Tdust) result(flux)
    implicit none
    real*8,intent(in)::x(nspecies), Tgas, Tdust
    real*8::flux(nreactions)

    call compute_rates(x, Tgas, Tdust)

    !! PREPROCESS_FLUXES

    flux(1) = kall(1) * x(idx_H) * x(idx_CH)
    flux(2) = kall(2) * x(idx_H) * x(idx_CH2)
    flux(3) = kall(3) * x(idx_H) * x(idx_CH3)
    flux(4) = kall(4) * x(idx_H) * x(idx_CH4)
    flux(5) = kall(5) * x(idx_H) * x(idx_OH)
    flux(6) = kall(6) * x(idx_H) * x(idx_H2O)
    flux(7) = kall(7) * x(idx_H) * x(idx_CO)
    flux(8) = kall(8) * x(idx_H) * x(idx_O2)
    flux(9) = kall(9) * x(idx_H2) * x(idx_C)
    flux(10) = kall(10) * x(idx_H2) * x(idx_CH)
    flux(11) = kall(11) * x(idx_H2) * x(idx_CH2)
    flux(12) = kall(12) * x(idx_H2) * x(idx_CH3)
    flux(13) = kall(13) * x(idx_H2) * x(idx_O)
    flux(14) = kall(14) * x(idx_H2) * x(idx_OH)
    flux(15) = kall(15) * x(idx_H2) * x(idx_O2)
    flux(16) = kall(16) * x(idx_C) * x(idx_CH2)
    flux(17) = kall(17) * x(idx_C) * x(idx_OH)
    flux(18) = kall(18) * x(idx_C) * x(idx_OH)
    flux(19) = kall(19) * x(idx_C) * x(idx_O2)
    flux(20) = kall(20) * x(idx_CH) * x(idx_O)
    flux(21) = kall(21) * x(idx_CH) * x(idx_O)
    flux(22) = kall(22) * x(idx_CH) * x(idx_CH4)
    flux(23) = kall(23) * x(idx_CH) * x(idx_O2)
    flux(24) = kall(24) * x(idx_CH2) * x(idx_CH2)
    flux(25) = kall(25) * x(idx_CH2) * x(idx_O)
    flux(26) = kall(26) * x(idx_CH2) * x(idx_O)
    flux(27) = kall(27) * x(idx_CH2) * x(idx_O)
    flux(28) = kall(28) * x(idx_CH2) * x(idx_CH4)
    flux(29) = kall(29) * x(idx_CH2) * x(idx_OH)
    flux(30) = kall(30) * x(idx_CH2) * x(idx_OH)
    flux(31) = kall(31) * x(idx_CH2) * x(idx_O2)
    flux(32) = kall(32) * x(idx_CH3) * x(idx_CH3)
    flux(33) = kall(33) * x(idx_CH3) * x(idx_OH)
    flux(34) = kall(34) * x(idx_CH3) * x(idx_OH)
    flux(35) = kall(35) * x(idx_CH3) * x(idx_H2O)
    flux(36) = kall(36) * x(idx_O) * x(idx_CH4)
    flux(37) = kall(37) * x(idx_O) * x(idx_OH)
    flux(38) = kall(38) * x(idx_O) * x(idx_H2O)
    flux(39) = kall(39) * x(idx_CH4) * x(idx_OH)
    flux(40) = kall(40) * x(idx_OH) * x(idx_OH)
    flux(41) = kall(41) * x(idx_H) * x(idx_CHj)
    flux(42) = kall(42) * x(idx_H) * x(idx_CH2j)
    flux(43) = kall(43) * x(idx_H) * x(idx_CH3j)
    flux(44) = kall(44) * x(idx_H2) * x(idx_Hej)
    flux(45) = kall(45) * x(idx_H2) * x(idx_Cj)
    flux(46) = kall(46) * x(idx_H2) * x(idx_CHj)
    flux(47) = kall(47) * x(idx_Hej) * x(idx_CO)
    flux(48) = kall(48) * x(idx_Cj) * x(idx_OH)
    flux(49) = kall(49) * x(idx_Hj) * x(idx_H2)
    flux(50) = kall(50) * x(idx_H) * x(idx_Hej)
    flux(51) = kall(51) * x(idx_H) * x(idx_Oj)
    flux(52) = kall(52) * x(idx_Hj) * x(idx_O)
    flux(53) = kall(53) * x(idx_Hj) * x(idx_H2O)
    flux(54) = kall(54) * x(idx_Hj) * x(idx_O2)
    flux(55) = kall(55) * x(idx_H2) * x(idx_Hej)
    flux(56) = kall(56) * x(idx_Hej) * x(idx_C)
    flux(57) = kall(57) * x(idx_Oj) * x(idx_CO)
    flux(58) = kall(58) * x(idx_H2j) * x(idx_E)
    flux(59) = kall(59) * x(idx_H3j) * x(idx_E)
    flux(60) = kall(60) * x(idx_H3j) * x(idx_E)
    flux(61) = kall(61) * x(idx_CHj) * x(idx_E)
    flux(62) = kall(62) * x(idx_CH2j) * x(idx_E)
    flux(63) = kall(63) * x(idx_CH2j) * x(idx_E)
    flux(64) = kall(64) * x(idx_CH2j) * x(idx_E)
    flux(65) = kall(65) * x(idx_CH3j) * x(idx_E)
    flux(66) = kall(66) * x(idx_CH3j) * x(idx_E)
    flux(67) = kall(67) * x(idx_CH3j) * x(idx_E)
    flux(68) = kall(68) * x(idx_CH3j) * x(idx_E)
    flux(69) = kall(69) * x(idx_CH4j) * x(idx_E)
    flux(70) = kall(70) * x(idx_CH4j) * x(idx_E)
    flux(71) = kall(71) * x(idx_OHj) * x(idx_E)
    flux(72) = kall(72) * x(idx_CH5j) * x(idx_E)
    flux(73) = kall(73) * x(idx_CH5j) * x(idx_E)
    flux(74) = kall(74) * x(idx_H2Oj) * x(idx_E)
    flux(75) = kall(75) * x(idx_H2Oj) * x(idx_E)
    flux(76) = kall(76) * x(idx_H2Oj) * x(idx_E)
    flux(77) = kall(77) * x(idx_H3Oj) * x(idx_E)
    flux(78) = kall(78) * x(idx_H3Oj) * x(idx_E)
    flux(79) = kall(79) * x(idx_H3Oj) * x(idx_E)
    flux(80) = kall(80) * x(idx_H3Oj) * x(idx_E)
    flux(81) = kall(81) * x(idx_COj) * x(idx_E)
    flux(82) = kall(82) * x(idx_HCOj) * x(idx_E)
    flux(83) = kall(83) * x(idx_O2j) * x(idx_E)
    flux(84) = kall(84) * x(idx_CH3j) * x(idx_E)
    flux(85) = kall(85) * x(idx_Hj) * x(idx_H)
    flux(86) = kall(86) * x(idx_H) * x(idx_C)
    flux(87) = kall(87) * x(idx_H) * x(idx_Cj)
    flux(88) = kall(88) * x(idx_H) * x(idx_O)
    flux(89) = kall(89) * x(idx_H) * x(idx_OH)
    flux(90) = kall(90) * x(idx_H2) * x(idx_C)
    flux(91) = kall(91) * x(idx_H2) * x(idx_Cj)
    flux(92) = kall(92) * x(idx_H2) * x(idx_CH)
    flux(93) = kall(93) * x(idx_H2) * x(idx_CH3j)
    flux(94) = kall(94) * x(idx_C) * x(idx_O)
    flux(95) = kall(95) * x(idx_Cj) * x(idx_O)
    flux(96) = kall(96) * x(idx_O) * x(idx_O)
    flux(97) = kall(97) * x(idx_H) * x(idx_H2)
    flux(98) = kall(98) * x(idx_H) * x(idx_CH)
    flux(99) = kall(99) * x(idx_H) * x(idx_OH)
    flux(100) = kall(100) * x(idx_H) * x(idx_H2O)
    flux(101) = kall(101) * x(idx_H) * x(idx_O2)
    flux(102) = kall(102) * x(idx_H2) * x(idx_E)
    flux(103) = kall(103) * x(idx_H2) * x(idx_H2)
    flux(104) = kall(104) * x(idx_H2) * x(idx_CH)
    flux(105) = kall(105) * x(idx_H2) * x(idx_OH)
    flux(106) = kall(106) * x(idx_H2) * x(idx_H2O)
    flux(107) = kall(107) * x(idx_H2) * x(idx_O2)
    flux(108) = kall(108) * x(idx_CH) * x(idx_O)
    flux(109) = kall(109) * x(idx_H) * x(idx_H)
    flux(110) = kall(110) * x(idx_Hj) * x(idx_CH2)
    flux(111) = kall(111) * x(idx_Hj) * x(idx_CH4)
    flux(112) = kall(112) * x(idx_H) * x(idx_CH4j)
    flux(113) = kall(113) * x(idx_H) * x(idx_CH5j)
    flux(114) = kall(114) * x(idx_H2j) * x(idx_H2)
    flux(115) = kall(115) * x(idx_H2j) * x(idx_C)
    flux(116) = kall(116) * x(idx_H2j) * x(idx_CH)
    flux(117) = kall(117) * x(idx_H2j) * x(idx_CH2)
    flux(118) = kall(118) * x(idx_H2) * x(idx_CH2j)
    flux(119) = kall(119) * x(idx_H2j) * x(idx_O)
    flux(120) = kall(120) * x(idx_H2) * x(idx_Oj)
    flux(121) = kall(121) * x(idx_H2j) * x(idx_CH4)
    flux(122) = kall(122) * x(idx_H2) * x(idx_CH4j)
    flux(123) = kall(123) * x(idx_H2j) * x(idx_CH4)
    flux(124) = kall(124) * x(idx_H2j) * x(idx_OH)
    flux(125) = kall(125) * x(idx_H2) * x(idx_OHj)
    flux(126) = kall(126) * x(idx_H2j) * x(idx_H2O)
    flux(127) = kall(127) * x(idx_H2) * x(idx_H2Oj)
    flux(128) = kall(128) * x(idx_H2j) * x(idx_CO)
    flux(129) = kall(129) * x(idx_H2) * x(idx_COj)
    flux(130) = kall(130) * x(idx_H3j) * x(idx_C)
    flux(131) = kall(131) * x(idx_H3j) * x(idx_CH)
    flux(132) = kall(132) * x(idx_H3j) * x(idx_CH2)
    flux(133) = kall(133) * x(idx_H3j) * x(idx_CH3)
    flux(134) = kall(134) * x(idx_H3j) * x(idx_O)
    flux(135) = kall(135) * x(idx_H3j) * x(idx_CH4)
    flux(136) = kall(136) * x(idx_H3j) * x(idx_OH)
    flux(137) = kall(137) * x(idx_H3j) * x(idx_H2O)
    flux(138) = kall(138) * x(idx_H3j) * x(idx_CO)
    flux(139) = kall(139) * x(idx_Hej) * x(idx_CH)
    flux(140) = kall(140) * x(idx_Hej) * x(idx_CH2)
    flux(141) = kall(141) * x(idx_Hej) * x(idx_CH2)
    flux(142) = kall(142) * x(idx_Hej) * x(idx_CH3)
    flux(143) = kall(143) * x(idx_Hej) * x(idx_CH4)
    flux(144) = kall(144) * x(idx_Hej) * x(idx_CH4)
    flux(145) = kall(145) * x(idx_Hej) * x(idx_CH4)
    flux(146) = kall(146) * x(idx_Hej) * x(idx_CH4)
    flux(147) = kall(147) * x(idx_Hej) * x(idx_OH)
    flux(148) = kall(148) * x(idx_Hej) * x(idx_H2O)
    flux(149) = kall(149) * x(idx_Hej) * x(idx_H2O)
    flux(150) = kall(150) * x(idx_Hej) * x(idx_CO)
    flux(151) = kall(151) * x(idx_Hej) * x(idx_O2)
    flux(152) = kall(152) * x(idx_C) * x(idx_OHj)
    flux(153) = kall(153) * x(idx_Cj) * x(idx_OH)
    flux(154) = kall(154) * x(idx_C) * x(idx_CH5j)
    flux(155) = kall(155) * x(idx_C) * x(idx_H2Oj)
    flux(156) = kall(156) * x(idx_Cj) * x(idx_H2O)
    flux(157) = kall(157) * x(idx_C) * x(idx_H3Oj)
    flux(158) = kall(158) * x(idx_C) * x(idx_HCOj)
    flux(159) = kall(159) * x(idx_Cj) * x(idx_O2)
    flux(160) = kall(160) * x(idx_Cj) * x(idx_O2)
    flux(161) = kall(161) * x(idx_C) * x(idx_O2j)
    flux(162) = kall(162) * x(idx_CHj) * x(idx_O)
    flux(163) = kall(163) * x(idx_CH) * x(idx_Oj)
    flux(164) = kall(164) * x(idx_CH) * x(idx_OHj)
    flux(165) = kall(165) * x(idx_CHj) * x(idx_OH)
    flux(166) = kall(166) * x(idx_CH) * x(idx_CH5j)
    flux(167) = kall(167) * x(idx_CHj) * x(idx_H2O)
    flux(168) = kall(168) * x(idx_CH) * x(idx_H2Oj)
    flux(169) = kall(169) * x(idx_CHj) * x(idx_H2O)
    flux(170) = kall(170) * x(idx_CH) * x(idx_H3Oj)
    flux(171) = kall(171) * x(idx_CH) * x(idx_COj)
    flux(172) = kall(172) * x(idx_CH) * x(idx_HCOj)
    flux(173) = kall(173) * x(idx_CHj) * x(idx_O2)
    flux(174) = kall(174) * x(idx_CHj) * x(idx_O2)
    flux(175) = kall(175) * x(idx_CH) * x(idx_O2j)
    flux(176) = kall(176) * x(idx_CH2j) * x(idx_O)
    flux(177) = kall(177) * x(idx_CH2) * x(idx_OHj)
    flux(178) = kall(178) * x(idx_CH2) * x(idx_CH5j)
    flux(179) = kall(179) * x(idx_CH2) * x(idx_H2Oj)
    flux(180) = kall(180) * x(idx_CH2) * x(idx_H3Oj)
    flux(181) = kall(181) * x(idx_CH2) * x(idx_COj)
    flux(182) = kall(182) * x(idx_CH2) * x(idx_HCOj)
    flux(183) = kall(183) * x(idx_CH2j) * x(idx_O2)
    flux(184) = kall(184) * x(idx_CH3j) * x(idx_O)
    flux(185) = kall(185) * x(idx_Oj) * x(idx_CH4)
    flux(186) = kall(186) * x(idx_O) * x(idx_CH4j)
    flux(187) = kall(187) * x(idx_Oj) * x(idx_OH)
    flux(188) = kall(188) * x(idx_O) * x(idx_OHj)
    flux(189) = kall(189) * x(idx_O) * x(idx_CH5j)
    flux(190) = kall(190) * x(idx_O) * x(idx_H2Oj)
    flux(191) = kall(191) * x(idx_CH4j) * x(idx_CH4)
    flux(192) = kall(192) * x(idx_CH4) * x(idx_OHj)
    flux(193) = kall(193) * x(idx_CH4) * x(idx_OHj)
    flux(194) = kall(194) * x(idx_CH4j) * x(idx_H2O)
    flux(195) = kall(195) * x(idx_CH4) * x(idx_H2Oj)
    flux(196) = kall(196) * x(idx_CH4j) * x(idx_CO)
    flux(197) = kall(197) * x(idx_CH4) * x(idx_COj)
    flux(198) = kall(198) * x(idx_OHj) * x(idx_OH)
    flux(199) = kall(199) * x(idx_OH) * x(idx_CH5j)
    flux(200) = kall(200) * x(idx_OHj) * x(idx_H2O)
    flux(201) = kall(201) * x(idx_OH) * x(idx_H2Oj)
    flux(202) = kall(202) * x(idx_OHj) * x(idx_CO)
    flux(203) = kall(203) * x(idx_OH) * x(idx_COj)
    flux(204) = kall(204) * x(idx_OH) * x(idx_HCOj)
    flux(205) = kall(205) * x(idx_CH5j) * x(idx_H2O)
    flux(206) = kall(206) * x(idx_CH5j) * x(idx_CO)
    flux(207) = kall(207) * x(idx_H2Oj) * x(idx_H2O)
    flux(208) = kall(208) * x(idx_H2Oj) * x(idx_CO)
    flux(209) = kall(209) * x(idx_H2O) * x(idx_COj)
    flux(210) = kall(210) * x(idx_H2O) * x(idx_HCOj)
    flux(211) = kall(211) * x(idx_H) * x(idx_H2j)
    flux(212) = kall(212) * x(idx_Hj) * x(idx_CH)
    flux(213) = kall(213) * x(idx_Hj) * x(idx_CH2)
    flux(214) = kall(214) * x(idx_Hj) * x(idx_CH3)
    flux(215) = kall(215) * x(idx_Hj) * x(idx_CH4)
    flux(216) = kall(216) * x(idx_Hj) * x(idx_OH)
    flux(217) = kall(217) * x(idx_H) * x(idx_COj)
    flux(218) = kall(218) * x(idx_H2j) * x(idx_CH)
    flux(219) = kall(219) * x(idx_H2j) * x(idx_CH2)
    flux(220) = kall(220) * x(idx_H2j) * x(idx_CH4)
    flux(221) = kall(221) * x(idx_H2j) * x(idx_OH)
    flux(222) = kall(222) * x(idx_H2j) * x(idx_H2O)
    flux(223) = kall(223) * x(idx_H2j) * x(idx_CO)
    flux(224) = kall(224) * x(idx_H2j) * x(idx_O2)
    flux(225) = kall(225) * x(idx_Hej) * x(idx_CH)
    flux(226) = kall(226) * x(idx_Hej) * x(idx_CH4)
    flux(227) = kall(227) * x(idx_Hej) * x(idx_H2O)
    flux(228) = kall(228) * x(idx_Hej) * x(idx_O2)
    flux(229) = kall(229) * x(idx_Cj) * x(idx_CH)
    flux(230) = kall(230) * x(idx_Cj) * x(idx_CH2)
    flux(231) = kall(231) * x(idx_C) * x(idx_COj)
    flux(232) = kall(232) * x(idx_C) * x(idx_O2j)
    flux(233) = kall(233) * x(idx_CH) * x(idx_Oj)
    flux(234) = kall(234) * x(idx_CH) * x(idx_OHj)
    flux(235) = kall(235) * x(idx_CH) * x(idx_H2Oj)
    flux(236) = kall(236) * x(idx_CH) * x(idx_COj)
    flux(237) = kall(237) * x(idx_CH) * x(idx_O2j)
    flux(238) = kall(238) * x(idx_CH2) * x(idx_Oj)
    flux(239) = kall(239) * x(idx_CH2) * x(idx_OHj)
    flux(240) = kall(240) * x(idx_CH2) * x(idx_H2Oj)
    flux(241) = kall(241) * x(idx_CH2) * x(idx_COj)
    flux(242) = kall(242) * x(idx_CH2) * x(idx_O2j)
    flux(243) = kall(243) * x(idx_Oj) * x(idx_CH4)
    flux(244) = kall(244) * x(idx_Oj) * x(idx_OH)
    flux(245) = kall(245) * x(idx_Oj) * x(idx_H2O)
    flux(246) = kall(246) * x(idx_O) * x(idx_COj)
    flux(247) = kall(247) * x(idx_Oj) * x(idx_O2)
    flux(248) = kall(248) * x(idx_CH4) * x(idx_COj)
    flux(249) = kall(249) * x(idx_CH4j) * x(idx_O2)
    flux(250) = kall(250) * x(idx_OHj) * x(idx_H2O)
    flux(251) = kall(251) * x(idx_OH) * x(idx_COj)
    flux(252) = kall(252) * x(idx_OHj) * x(idx_O2)
    flux(253) = kall(253) * x(idx_H2O) * x(idx_COj)
    flux(254) = kall(254) * x(idx_H2Oj) * x(idx_O2)
    flux(255) = kall(255) * x(idx_COj) * x(idx_O2)
    flux(256) = kall(256) * x(idx_Hj) * x(idx_E)
    flux(257) = kall(257) * x(idx_Hej) * x(idx_E)
    flux(258) = kall(258) * x(idx_Hej) * x(idx_E)
    flux(259) = kall(259) * x(idx_Hejj) * x(idx_E)
    flux(260) = kall(260) * x(idx_Cj) * x(idx_E)
    flux(261) = kall(261) * x(idx_Cjj) * x(idx_E)
    flux(262) = kall(262) * x(idx_Cjjj) * x(idx_E)
    flux(263) = kall(263) * x(idx_Cjjjj) * x(idx_E)
    flux(264) = kall(264) * x(idx_Oj) * x(idx_E)
    flux(265) = kall(265) * x(idx_Ojj) * x(idx_E)
    flux(266) = kall(266) * x(idx_Ojjj) * x(idx_E)
    flux(267) = kall(267) * x(idx_Ojjjj) * x(idx_E)
    flux(268) = kall(268) * x(idx_H) * x(idx_E)
    flux(269) = kall(269) * x(idx_He) * x(idx_E)
    flux(270) = kall(270) * x(idx_Hej) * x(idx_E)
    flux(271) = kall(271) * x(idx_C) * x(idx_E)
    flux(272) = kall(272) * x(idx_Cj) * x(idx_E)
    flux(273) = kall(273) * x(idx_Cjj) * x(idx_E)
    flux(274) = kall(274) * x(idx_Cjjj) * x(idx_E)
    flux(275) = kall(275) * x(idx_O) * x(idx_E)
    flux(276) = kall(276) * x(idx_Oj) * x(idx_E)
    flux(277) = kall(277) * x(idx_Ojj) * x(idx_E)
    flux(278) = kall(278) * x(idx_Ojjj) * x(idx_E)
    flux(279) = kall(279) * x(idx_CO)
    flux(280) = kall(280) * x(idx_CO_DUST)
    flux(281) = kall(281) * x(idx_H2O)
    flux(282) = kall(282) * x(idx_H2O_DUST)
    flux(283) = kall(283) * x(idx_H)
    flux(284) = kall(284) * x(idx_He)
    flux(285) = kall(285) * x(idx_Hej)
    flux(286) = kall(286) * x(idx_O)
    flux(287) = kall(287) * x(idx_Oj)
    flux(288) = kall(288) * x(idx_Ojj)
    flux(289) = kall(289) * x(idx_Ojjj)
    flux(290) = kall(290) * x(idx_C)
    flux(291) = kall(291) * x(idx_Cj)
    flux(292) = kall(292) * x(idx_Cjj)
    flux(293) = kall(293) * x(idx_Cjjj)
    flux(294) = kall(294) * x(idx_H2)
    flux(295) = kall(295) * x(idx_CO)
    flux(296) = kall(296) * x(idx_H2j)
    flux(297) = kall(297) * x(idx_CH)
    flux(298) = kall(298) * x(idx_CH)
    flux(299) = kall(299) * x(idx_CHj)
    flux(300) = kall(300) * x(idx_CH2)
    flux(301) = kall(301) * x(idx_CH2j)
    flux(302) = kall(302) * x(idx_CH3)
    flux(303) = kall(303) * x(idx_CH3)
    flux(304) = kall(304) * x(idx_CH4)
    flux(305) = kall(305) * x(idx_OH)
    flux(306) = kall(306) * x(idx_OHj)
    flux(307) = kall(307) * x(idx_H2O)
    flux(308) = kall(308) * x(idx_H2O)
    flux(309) = kall(309) * x(idx_O2)
    flux(310) = kall(310) * x(idx_O2)
    flux(311) = kall(311) * x(idx_H2)
    flux(312) = kall(312) * x(idx_H2)
    flux(313) = kall(313) * x(idx_H2)
    flux(314) = kall(314) * x(idx_H)
    flux(315) = kall(315) * x(idx_He)

    !! PREPROCESS_END

  end function get_flux

end module prizmo_flux
